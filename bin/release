#!/usr/bin/env bash

PACKAGE_VERSION=$(cat package.json \
  | grep version \
  | head -1 \
  | awk -F: '{ print $2 }' \
  | sed 's/[",]//g' \
  | tr -d '[[:space:]]')

echo "You're about to release the next version of kitten $PACKAGE_VERSION"
bin/install
npm test
git checkout -b release/v${PACKAGE_VERSION}
npm run build:js
npm run build:utilities
git add .
git commit -m "add built js files for $PACKAGE_VERSION"
npm --no-git-tag-version version ${PACKAGE_VERSION}
git add .
git commit -m "bump kitten version to $PACKAGE_VERSION"
git push origin release/v${PACKAGE_VERSION}
echo "Done! You can now create a release PR: https://github.com/KissKissBankBank/kitten/compare/release/v${PACKAGE_VERSION}?expand=1 ðŸ˜¸"
