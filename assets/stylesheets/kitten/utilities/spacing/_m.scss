/// Margin utilities based on spacing tokens.
///
/// @group spacing
///
/// @example scss - Usage
///
///   @include k-utilities-m;
///
/// @example html
///
///   <div class="k-u-m-0">…</div>
///   <div class="k-u-m-auto">…</div>
///   <div class="k-u-m-1@s-up">…</div>
///   <div class="k-u-m-2@xs-down">…</div>
///   <div class="k-u-m-n10@xl-down">…</div>

@mixin k-u-m($position, $attributes, $slug, $size) {
  $first-char: str-slice($slug, 1, 1);

  .k-u-m-#{$position}-#{$slug} {
    @if $size == 'auto' {
      @each $attr in $attributes {
        margin-#{$attr}: auto !important;
      }
    } @else if $first-char == 'n' {
      @each $attr in $attributes {
        margin-#{$attr}: calc(-1 * var(--spacing-#{$size})) !important;
      }
    } @else {
      @each $attr in $attributes {
        margin-#{$attr}: var(--spacing-#{$size}) !important;
      }
    }
  }
}

@mixin k-utilities-m {
  .k-u-m-0 {
    margin: 0 !important;
  }

  $k-sizes: (
    '0': '0',
    '1': '1',
    '2': '2',
    '3': '3',
    '4': '4',
    '5': '5',
    '6': '6',
    '7': '7',
    '8': '8',
    '9': '9',
    '10': '10',
    '11': '11',
    '12': '12',
    'n1': '1',
    'n2': '2',
    'n3': '3',
    'n4': '4',
    'n5': '5',
    'n6': '6',
    'n7': '7',
    'n8': '8',
    'n9': '9',
    'n10': '10',
    'n11': '11',
    'n12': '12',
    'auto': 'auto',
  );

  $k-variants: (
    v: ('top', 'bottom'),
    h: ('left', 'right'),
    t: ('top'),
    b: ('bottom'),
    l: ('left'),
    r: ('right'),
  );

  @each $variant_name, $attribute in $k-variants {
    @each $size_name, $size in $k-sizes {
      @include k-u-m(
        $variant_name,
        $attribute,
        $size_name,
        $size,
      );
    }
  }

  @each $mq_name, $query in reverse($k-media-queries) {
    $addendum: \@#{$mq_name}-down;

    @if $mq_name != "xl" {
      @include k-media-max($mq_name) {
        @each $variant_name, $attribute in $k-variants {
          @each $size_name, $size in $k-sizes {
            @include k-u-m(
              $variant_name,
              $attribute,
              $size_name + $addendum,
              $size,
            );
          }
        }
      }
    }
  }

  @each $mq_name, $query in $k-media-queries {
    $addendum: \@#{$mq_name}-up;

    @if $mq_name != "xxs" {
      @include k-media-min($mq_name) {
        @each $variant_name, $attribute in $k-variants {
          @each $size_name, $size in $k-sizes {
            @include k-u-m(
              $variant_name,
              $attribute,
              $size_name + $addendum,
              $size,
            );
          }
        }
      }
    }
  }
}
